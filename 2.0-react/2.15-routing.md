# 2.15 - Routing

## Routing

Lo que dicen en la documentaci√≥n

> React Router keeps your UI in sync with the URL. It has a simple API with powerful features like lazy code loading, dynamic route matching, and location transition handling built right in. Make the URL your first thought, not an after-thought.

### A√±adir el router

Creamos una apliaci√≥n nueva y, cuando acabe de crearse ‚åõÔ∏è, instalamos el router.

`npm i -S react-router`

e importamos en nuestro App.js

```javascript
import {
  Router, Route, Link, IndexRoute, hashHistory, browserHistory
} from 'react-router';
```

Ahora vamos a a√±adir una ruta b√°sica. Para ello, necesitamos declarar el contenedor de rutas y la ruta junto con los componentes asociados:

```javascript
const Oficina = () => <h1>Esta es una oficina</h1>
const Direccion = () => <h1>Esta es la direcci√≥n</h1>

class App extends Component {
  render() {
    return (
      <Router history={hashHistory}>
        <Route path='/' component={Oficina} />
        <Route path='/direccion' component={Direccion} />
      </Router>
    )
  }
}
```

### Hist√≥rico

Estamos usando `hashHistory` para el historial del navegaci√≥n. Maneja el historial con la parte hash de la url. A√±ade ese extra para simular algunos comportamientos que el navegador tiene de forma nativa al usar urls reales. Podemos cambiarlo por `browserHistory`. Cuando se utiliza el browserHistory debemos tener un servidor que siempre devolver√° la aplicaci√≥n en cualquier ruta; por ejemplo si usamos nodejs, una configuraci√≥n como la siguiente funcionar√≠a:

```javascript
const express = require('express')
const path = require('path')
const port = process.env.PORT || 8080
const app = express()

// serve static assets normally
app.use(express.static(__dirname + '/public'))

// handle every other route with index.html, which will contain
// a script tag to your application's JavaScript file(s).
app.get('*', function (request, response){
  response.sendFile(path.resolve(__dirname, 'public', 'index.html'))
})

app.listen(port)
```

## 404

¬øQu√© pasa si llegamos a una ruta que no est√° definida? Vamos a configurar una ruta 404 y el componente que volver√° si la ruta no se encuentra.

```javascript
const NotFound = () => (
  <h1>
    Ups!! Necesito un TomTom porque no encuentro la direcci√≥n
    que me pides. Solo encuentro un 404. ¬øTu sabes algo? üôÑ
  </h1>);

// y dentro del Router a√±adimos
<Route path='*' component={NotFound} />
```

## Ruta por defecto

Para indicar cu√°l es la ruta por defecto - a la que se navegar√° si no se pone parte del path - usaremos `IndexRoute`. Para ello modificaremos el c√≥digo un poco.

```javascript
import {
  Router, Route, IndexRoute, DefaultRoute
  hashHistory, browserHistory,
  Link
} from 'react-router';

class App extends Component {
  render () {
    return (
      <Router history={hashHistory}>
        <Route path='/' component={Contenedor}>
          <IndexRoute component={Oficina} />
          <Route path='direccion' component={Direccion} />
          <Route path='*' component={NotFound} />
        </Route>
      </Router>
    )
  }
}

const Nav = () => (
  <div>
    <Link to='/'>Oficina</Link>&nbsp;
    <Link to='/direccion'>Oficina</Link>
  </div>
)

const Container = (props) => (<div>
  <Nav />
  {props.children}
</div>);

const Oficina = () => <h1>Esta es una oficina</h1>
const Direccion = () => <h1>Esta es la direcci√≥n</h1>
const NotFound = () => (
  <h1>
    Ups!! Necesito un TomTom porque no encuentro la direcci√≥n
    que me pides. Solo encuentro un 404. ¬øTu sabes algo? üôÑ
  </h1>);

export default App
```

**Nota:**  Puede haber m√∫ltiples `IndexRoute`.

## Par√°metros

#### Par√°metros de ruta

Digamos que tenemos esta ruta

```javascript
<Route path='/about/:name' component={About} />
```

Para acceder a los par√°metros de la ruta, simplemente accedemos a ellos a trav√©s de \`props.params'.

```javascript
const About = (props) => (
  <div>
    <h3>Welcome to the About Page</h3>
    <h2>{props.params.name}</h2>
  </div>
)
```

La ruta para acceder ser√≠a `http://localhost:8100/#/about/bitio` pero si no ponemos un par√°metro de nombre, obtendremos un 404. Si queremos que el par√°metro sea opcional lo pondremos entre par√©ntesis

```javascript
<Route path='/about/(:name)' component={About} />
```

#### Querystring

Acceder a los par√°metros que vienen en el querystring no es mucho m√°s complicado. Supongamos que viene un par√°metro llamado `refOf`. Acceder a √©l ser√≠a, otra vez, a trav√©s de props de la siguiente manera: `props.location.refOf`.

### Enlaces de inter√©s

[https://github.com/reactjs/react-router-tutorial](https://github.com/reactjs/react-router-tutorial)

